#include <inttypes.h>
#include <string.h>
#include <unistd.h>
#include <sys/mman.h>

int volatile main()
{
        /*0x00000A21646C726F57202C6F6C6C6548;*/

        __uint128_t v =
        ((__uint128_t)0x00000A21646C726F << 64) |
         (__uint128_t)0x57202C6F6C6C6548;

/*
        sub     rsp, 16

        mov     rax, 0x00000A21646C726F
        push    rax

        mov     rax, 0x57202C6F6C6C6548
        push    rax

        mov     rax, 0x01
        mov     rdi, 0x01
        mov     rsi, rsp
        mov     rdx, 0x07
        syscall
        add     rsp, 7
        mov     rax, 0x01
        mov     rdi, 0x01
        mov     rsi, rsp
        mov     rdx, 0x07
        syscall

        add     rsp, 9
        mov     rax, 0x00
        ret 
*/

        unsigned char _00000A21646C726F57202C6F6C6C6548[] = {
        0x48, 0x83, 0xEC, 0x10,
        0x48, 0xB8, 0x6F, 0x72, 0x6C, 0x64, 0x21, 0x0A, 0x00, 0x00, 0x50,
        0x48, 0xB8, 0x48, 0x65, 0x6C, 0x6C, 0x6F, 0x2C, 0x20, 0x57, 0x50,
        0xB8, 0x01, 0x00, 0x00, 0x00,
        0xBF, 0x01, 0x00, 0x00, 0x00,
        0x48, 0x89, 0xE6,
        0xBA, 0x07, 0x00, 0x00, 0x00,
        0x0F, 0x05,
        0x48, 0x83, 0xC4, 0x07,
        0xB8, 0x01, 0x00, 0x00, 0x00,
        0xBF, 0x01, 0x00, 0x00, 0x00,
        0x48, 0x89, 0xE6,
        0xBA, 0x07, 0x00, 0x00, 0x00,
        0x0F, 0x05,
        
        0x48, 0x83, 0xC4, 0x09,
        0xB8, 0x00, 0x00, 0x00, 0x00,

        0xB8, 0x3C, 0x00, 0x00, 0x00,
        0x48, 0x31, 0xFF,
        0x0F, 0x05
        };

        void * memory = mmap(NULL, 0x59,
                        PROT_READ | PROT_WRITE | PROT_EXEC,
                        MAP_PRIVATE | MAP_ANONYMOUS, -0x01, 0x00);

        memcpy(memory, _00000A21646C726F57202C6F6C6C6548, 0x59);

        int (*_)(void) = (int (*)(void))memory;
        _();
}
